# The Dark Mode - 技術仕様

## 技術スタック

### 基本技術
- **HTML/CSS/JavaScript**: 拡張機能のUIとロジックを構築
- **Chrome Extension API**: Chrome拡張機能としての機能実装
  - `chrome.storage`: 設定の保存
  - `chrome.tabs`: タブ情報へのアクセス
  - `chrome.scripting`: CSSの挿入

### ファイル構成
```
/
├── manifest.json        # 拡張機能のメタデータと設定
├── popup.html           # ポップアップUI
├── popup.css            # ポップアップのスタイル
├── popup.js             # ポップアップの動作制御
├── background.js        # バックグラウンド処理
├── content.js           # コンテンツスクリプト
├── themes/              # テーマファイル
│   ├── theme1.css       # ダークテーマ1
│   ├── theme2.css       # ダークテーマ2
│   └── theme3.css       # ダークテーマ3
└── icons/               # アイコン画像
    ├── icon16.png       # 16x16 アイコン
    ├── icon48.png       # 48x48 アイコン
    └── icon128.png      # 128x128 アイコン
```

## 開発手法
- モジュール型の開発: 各機能を独立したモジュールに分割
- イベント駆動型プログラミング: Chromeイベントとユーザーインタラクションに基づいた設計
- 永続的状態管理: `chrome.storage.sync` を使用した設定の保存と同期

## コーディング規約
- 変数名・関数名: camelCase
- 定数: UPPER_SNAKE_CASE
- コメント: 複雑なロジックには適切なコメントを付記
- エラーハンドリング: 主要な操作には適切なエラー処理を実装

## データフロー
1. ユーザーがポップアップUIでスイッチやテーマを選択
2. 選択内容が `chrome.storage.sync` に保存
3. content.js が現在のページにCSSを適用または解除
4. background.js がタブ変更時やページ読み込み時に状態を監視し適切なアクションを実行

## テーマ設計
各テーマは以下の要素をカスタマイズ:
- 背景色（ページ全体とコンテナ要素）
- 文字色（通常テキスト、リンク、訪問済みリンク）
- ボーダー色
- 入力フォーム要素の色

すべてのテーマで共通の特徴:
- 高コントラスト: テキストは背景に対して十分な可読性を持つ
- !important 宣言: サイトの元のスタイルを上書き
- 画像非変更: 画像の色や明るさは変更せず 